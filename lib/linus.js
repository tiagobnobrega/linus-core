!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("lodash")):"function"==typeof define&&define.amd?define(["lodash"],r):"object"==typeof exports?exports.linus=r(require("lodash")):e.linus=r(e._)}(this,function(e){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=5)}([function(e,r,t){"use strict";e.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"numbers";return function(r){return t={},n=e,o=r.toUpperCase(),n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t;var t,n,o}}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(0);Object.defineProperty(r,"Numbers",{enumerable:!0,get:function(){return(e=n,e&&e.__esModule?e:{default:e}).default;var e}})},function(e,r,t){"use strict";e.exports=function e(r){var t=new Error('Required parameter, "'+r+'" is missing.');throw"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(t,e),t}},function(r,t){r.exports=e},function(e,r,t){"use strict";function n(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)}function o(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){return function n(o,i){try{var u=r[o](i),a=u.value}catch(e){return void t(e)}if(!u.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}("next")})}}var i=t(3),u=t(2);e.exports=function(e){var r,t,a={},c={},s=function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!(e&&e.id&&e.tokenize&&i.isFunction(e.tokenize)))throw new Error("invalid tokenizer "+(e&&e.id)+": missing or invalid attribute id or fn");if(!1===r&&c[e.id.toString()])throw new Error("tokenizer "+e.id+" already registered & overwrite attribute false");c[e.id]=e.tokenize},f=(r=o(regeneratorRuntime.mark(function e(r,t){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.map(function(e){return Promise.resolve(e.tokenize(r))}),e.abrupt("return",Promise.all(o).then(function(e){return Object.assign.apply(Object,n(e))}));case 2:case"end":return e.stop()}},e,void 0)})),function(e,t){return r.apply(this,arguments)}),d=function(e){var r=c[e];if(!r)throw new Error("Tokenizer "+e+" not registered.");return r},l=function(e){return e?e.map(d):[]},p=function(e){var r=l(a.bot.globalTokenizers),t=l(e.beforeGlobaltokenizers||[]),o=l(e.afterGlobaltokenizers||[]);return[].concat(n(t),n(r),n(o))};(void 0).use=function(e){var r=e.tokenizers,t=void 0===r?[]:r;(void 0).registerTokenizers(t)},(void 0).registerTokenizers=function(e){e.forEach(s)},(void 0).registerTokenizer=function(e){return s(e)},(void 0).resolve=(t=o(regeneratorRuntime.mark(function e(r,t){var n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.env.topicId,n=a.topics[i]||a.bot.rootTopic,o=p(n),e.next=4,f(r,o);case 4:e.sent;case 5:case"end":return e.stop()}var i},e,void 0)})),function(e,r){return t.apply(this,arguments)}),v=e.bot,b=void 0===v?u("bot"):v,y=e.topics,h=void 0===y?[]:y,m=e.interactions,g=void 0===m?[]:m,k=e.handlers,w=void 0===k?[]:k,e.tokenizers,a={bot:b,topics:i.keyBy(h,"id"),interactions:i.keyBy(g,function(e){return e.topicId+":"+e.id})},w.forEach((void 0).use);var v,b,y,h,m,g,k,w}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.tokenizers=r.LinusDialog=void 0;var n=t(4);Object.defineProperty(r,"LinusDialog",{enumerable:!0,get:function(){return(e=n,e&&e.__esModule?e:{default:e}).default;var e}});var o=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}(t(1));r.tokenizers=o}])});