!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("lodash")):"function"==typeof define&&define.amd?define(["lodash"],e):"object"==typeof exports?exports.LinusDialog=e(require("lodash")):(r.linus=r.linus||{},r.linus.LinusDialog=e(r._))}(this,function(r){return function(r){var e={};function t(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return r[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=r,t.c=e,t.d=function(r,e,n){t.o(r,e)||Object.defineProperty(r,e,{configurable:!1,enumerable:!0,get:n})},t.r=function(r){Object.defineProperty(r,"__esModule",{value:!0})},t.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(e,"a",e),e},t.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},t.p="",t(t.s=6)}([,,,,function(r,e,t){"use strict";r.exports=function r(e){var t=new Error('Required parameter, "'+e+'" is missing.');throw"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(t,r),t}},function(e,t){e.exports=r},function(r,e,t){"use strict";function n(r){if(Array.isArray(r)){for(var e=0,t=Array(r.length);e<r.length;e++)t[e]=r[e];return t}return Array.from(r)}function o(r){return function(){var e=r.apply(this,arguments);return new Promise(function(r,t){return function n(o,i){try{var u=e[o](i),a=u.value}catch(r){return void t(r)}if(!u.done)return Promise.resolve(a).then(function(r){n("next",r)},function(r){n("throw",r)});r(a)}("next")})}}var i=t(5),u=t(4);r.exports=function(r){var e,t,a={},c={},s=function(r){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!(r&&r.id&&r.tokenize&&i.isFunction(r.tokenize)))throw new Error("invalid tokenizer "+(r&&r.id)+": missing or invalid attribute id or fn");if(!1===e&&c[r.id.toString()])throw new Error("tokenizer "+r.id+" already registered & overwrite attribute false");c[r.id]=r.tokenize},f=(e=o(regeneratorRuntime.mark(function r(e,t){var o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return o=t.map(function(r){return Promise.resolve(r.tokenize(e))}),r.abrupt("return",Promise.all(o).then(function(r){return Object.assign.apply(Object,n(r))}));case 2:case"end":return r.stop()}},r,void 0)})),function(r,t){return e.apply(this,arguments)}),d=function(r){var e=c[r];if(!e)throw new Error("Tokenizer "+r+" not registered.");return e},p=function(r){return r?r.map(d):[]},l=function(r){var e=p(a.bot.globalTokenizers),t=p(r.beforeGlobaltokenizers||[]),o=p(r.afterGlobaltokenizers||[]);return[].concat(n(t),n(e),n(o))};(void 0).use=function(r){var e=r.tokenizers,t=void 0===e?[]:e;(void 0).registerTokenizers(t)},(void 0).registerTokenizers=function(r){r.forEach(s)},(void 0).registerTokenizer=function(r){return s(r)},(void 0).resolve=(t=o(regeneratorRuntime.mark(function r(e,t){var n,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=t.env.topicId,n=a.topics[i]||a.bot.rootTopic,o=l(n),r.next=4,f(e,o);case 4:r.sent;case 5:case"end":return r.stop()}var i},r,void 0)})),function(r,e){return t.apply(this,arguments)}),v=r.bot,h=void 0===v?u("bot"):v,y=r.topics,b=void 0===y?[]:y,g=r.interactions,k=void 0===g?[]:g,m=r.handlers,x=void 0===m?[]:m,r.tokenizers,a={bot:h,topics:i.keyBy(b,"id"),interactions:i.keyBy(k,function(r){return r.topicId+":"+r.id})},x.forEach((void 0).use);var v,h,y,b,g,k,m,x}}])});